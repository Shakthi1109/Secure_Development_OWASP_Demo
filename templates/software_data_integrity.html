{% extends "base.html" %}

{% block title %}Software & Data Integrity Failures - {{ mode.title() }}{% endblock %}

{% block back %}
  <a href="/mode/{{ mode }}" class="back-arrow">‚Üê</a>
{% endblock %}

{% block content %}
<div class="page-wrapper">
  <div class="login-container">
    <h2>üõ†Ô∏è A08 - Software & Data Integrity Failures <span class="mode-tag">({{ mode.title() }})</span></h2>
    <form method="POST">
      <label for="data">Enter JSON:</label>
      <textarea name="data" id="data" rows="5" placeholder='{ "name": "User" }'></textarea>
      <button type="submit">Submit</button>
    </form>


    {% if result %}
      <p class="message"><strong>Result:</strong> {{ result }}</p>
    {% endif %}
  </div>

  <div class="info-box">
    <div class="toggle-item">
      <button type="button" class="toggle-btn" onclick="toggleVisibility('hint-text')">Hint</button>
      <p id="hint-text" class="toggle-text">
        <br>Insecure: Try <br>{"name": __import__('os').system('echo HACKED')}</br>
        <br>Secure: Try { "name": "User" }</br>
        
      </p>
    </div>
    <div class="toggle-item">
      <button type="button" class="toggle-btn" onclick="toggleVisibility('description-text')">Description</button>
      <p id="description-text" class="toggle-text">
        Software and Data Integrity Failures occur when untrusted data or code is accepted without validation, leading to security breaches.
        This vulnerability shows how insecure deserialization can allow attackers to execute arbitrary system commands. The code executes a command on the server. While it returns 0 (the exit code), the real danger is in what gets executed behind the scenes.
      </p>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  function toggleVisibility(id) {
    const el = document.getElementById(id);
    if (el.style.display === 'block') {
      el.style.display = 'none';
    } else {
      el.style.display = 'block';
    }
  }
</script>
{% endblock %}
